#include <stdlib.h> 
#include <stdio.h>
#include <assert.h>
#include <stdbool.h>
#define nb_monnaie 5

// Definition du type monnaie
struct t_monnaie{
    float  valeur;
    char devise;
};
typedef struct t_monnaie t_monnaie; 
/**
 * \brief Initialiser une monnaie 
 * \param[out] t_monnaie monnaie à initilaiser
 * \param[in] valeur 
 * \param[in] devise
 * \pre valeur > 0
 */ 
void initialiser(t_monnaie monnaie, float valeur, char devise) {
    assert(valeur > 0);
    monnaie.valeur = valeur;
    monnaie.devise = devise;
}


/**
 * \brief Ajouter une monnaie m2 à une monnaie m1 
 * \param[in] m1 la monnaie 1
 * \param[in] m2 la monnaie 2
 * \pre devise1 = devise2 
 */ 
bool ajouter(t_monnaie* p1, t_monnaie* p2) {
    bool booleen;
    if (*p1.devise == *p2.devise){
       initialiser(*p2, *p1.valeur + *p2.valeur, *p2.devise);
       booleen = true;
    }
    else {
       booleen = false;
    }	
    return booleen;
}


/**
 * \brief Tester Initialiser 
 * \param[]
 */ 
void tester_initialiser() {
    float valeur = 3;
    char devise = 'e';
    t_monnaie m;
    initialiser(m, valeur, devise);
    assert(m.valeur == valeur && m.devise == devise);
    
}

/**
 * \brief Tester Ajouter 
 * \param[]
 */ 
void tester_ajouter() {
   t_monnaie m1, m2, m;
   initialiser(m1, 3, 'e');
   initialiser(m2, 4, 'e');
   assert(ajouter(m1,m2) && m2.valeur == 7 && m2.devise == 'e');

   initialiser(m2, 4, '$');
   assert(ajouter(m1, m2) == false && m2.valeur != 7 && m2.devise != 'e');
  
}


int main(void) {
    // Déclarer un tableau de 5 monnaies
    typedef t_monnaie t_tab_monnaie[nb_monnaie];
    t_tab_monnaie tab_monnaie;
    //Initialiser les monnaies
    float valeur;
    char devise;
    for (int i = 0; i <= nb_monnaie - 1; i ++) {
	printf("Saisir une valeur et une devise pour la monnaie %i.\n", i);
	scanf("%f %c", &valeur, &devise);
        initialiser(*(tab_monnaie + i), valeur, devise);
    }
    printf("Saisir la devise des monnaies que vous voulez ajouter.\n");
    scanf(" %c", &devise);
    t_monnaie m;
    m.valeur = 0;
    m.devise = devise;
    for (int j = 0; j <= nb_monnaie - 1; j ++) {
	ajouter((tab_monnaie + j), &m);
    }
    printf("La somme des monnaies de devise %c est: %f.\n", devise, m.valeur);
}
